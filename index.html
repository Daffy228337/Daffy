<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delivery Simulation</title>
    <script src="https://api-maps.yandex.ru/2.1/?apikey=0f2d1024-aa27-4ceb-b1cc-284236a7812d&lang=ru_RU" type="text/javascript"></script>
</head>
<body>
    <div id="map" style="width: 100%; height: 400px;"></div>
    <button id="addCourierBtn">Добавить курьера</button>
    <button id="removeCourierBtn">Убрать курьера</button>
    <button id="createOrderBtn">Создать заказ</button>
    <button id="assignOrderBtn">Назначить заказ</button>
    <div id="orderLog"></div>
    <div id="courierOrdersLog"></div>

    <script>
        ymaps.ready(init);

        let map;
        let sectors = [];
        let orders = [];
        let couriers = [];

        function init() {
            map = new ymaps.Map("map", {
                center: [48.7093, 44.5174],
                zoom: 12
            });

            createSectors();

            document.getElementById("addCourierBtn").addEventListener("click", addCourier);
            document.getElementById("removeCourierBtn").addEventListener("click", removeCourier);
            document.getElementById("createOrderBtn").addEventListener("click", createOrder);
            document.getElementById("assignOrderBtn").addEventListener("click", assignOrder);
        }

        function createSectors() {
            let restaurantCoords = [48.7093, 44.5174];
            let radius = 2000; // Радиус секторов

            let colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00']; // Цвета для секторов

            for (let i = 0; i < 4; i++) {
                let startAngle = i * Math.PI / 2;
                let endAngle = (i + 1) * Math.PI / 2;

                let sectorGeometry = new ymaps.geometry.Polygon.fromEncodedCoordinates([
                    ymaps.util.polygon.getCoordinates(restaurantCoords, radius, startAngle, endAngle)
                ]);

                let sector = new ymaps.Polygon([sectorGeometry], {}, {
                    fillColor: colors[i],
                    strokeColor: colors[i],
                    opacity: 0.5
                });

                sectors.push(sector);
                map.geoObjects.add(sector);
            }
        }

        function addCourier() {
            let courierNumber = couriers.length + 1;
            couriers.push({ number: courierNumber, orders: [] });
            document.getElementById("courierOrdersLog").innerText += `Курьер номер ${courierNumber}\n`;
        }

        function removeCourier() {
            if (couriers.length > 0) {
                let removedCourier = couriers.pop();
                document.getElementById("courierOrdersLog").innerText += `Курьер номер ${removedCourier.number} удален\n`;
            }
        }

        function createOrder() {
            let sectorIndex = Math.floor(Math.random() * 4);
            let sectorLetter = String.fromCharCode(65 + sectorIndex); // A, B, C, D
            let time = new Date().toLocaleTimeString('ru-RU', { timeZone: 'Europe/Moscow' });
            orders.push({ sector: sectorLetter, time: time });
            document.getElementById("orderLog").innerText += `Заказ Сектор ${sectorLetter}. ${time}\n`;
        }

        function assignOrder() {
            let newOrder = orders.pop();
            let assignedCourier = assignCourier(newOrder);
            assignedCourier.orders.push(newOrder.sector);
            document.getElementById("courierOrdersLog").innerText += `Курьер номер ${assignedCourier.number}. Заказ ${newOrder.sector}\n`;
        }

        function assignCourier(order) {
            // Логика назначения заказа на курьера
            return couriers[0]; // Пример: всегда назначаем первого курьера
        }
    </script>
</body>
</html>